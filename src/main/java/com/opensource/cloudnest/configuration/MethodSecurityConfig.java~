package com.opensource.cloudnest.configuration;

import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.security.config.annotation.method.configuration.EnableGlobalMethodSecurity;
import org.springframework.security.config.annotation.method.configuration.GlobalMethodSecurityConfiguration;
import org.springframework.security.core.userdetails.UserDetailsService;
import org.springframework.security.web.SecurityFilterChain;

@Configuration
@EnableGlobalMethodSecurity(prePostEnabled = true)  // Enable @PreAuthorize and other annotations
public class MethodSecurityConfig extends GlobalMethodSecurityConfiguration {

    private final CustomPermissionEvaluator customPermissionEvaluator;

    public MethodSecurityConfig(CustomPermissionEvaluator customPermissionEvaluator) {
        this.customPermissionEvaluator = customPermissionEvaluator;
    }

    @Override
    protected void configure(MethodSecurityConfigurer config) {
        // Set the custom PermissionEvaluator
        config.setPermissionEvaluator(customPermissionEvaluator);
    }
    }
